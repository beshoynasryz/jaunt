<main id="main" class="main">

    <div class="pagetitle">
      <h1>Dashboard</h1>
      <nav>
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="/admin">Home</a></li>
          <li class="breadcrumb-item active">Dashboard</li>
        </ol>
      </nav>
    </div><!-- End Page Title -->
  
    <section class="section dashboard">
      <div class="row">
  
        
        <!-- Left side columns -->
        <div class="col-lg-8">
          <div class="row">
  
         
  
                <% if (!owner.isAdmin) {%>
                  <!-- Top Selling -->
                  <div class="col-12">
                    <div class="card top-selling overflow-auto">
                    <div class="card-body pb-0">
                      <h5 class="card-title">Places</h5>
                      <div class="filter">
                        <a class="icon" href="/admin/places/owner-places">See All</a>
                    </div>
  
                  <table class="table text-center">
                    <thead>
                      <tr>
                        <th scope="col">Picture</th>
                        <th scope="col">Governorate</th>
                        <th scope="col">Area</th>
                        <th scope="col">Capacity</th>
                        <th scope="col">Min Budget</th>
                      </tr>
                    </thead>
                    <tbody class="text-center">
                      <% places.forEach(function(place){ %>
                      <tr>
                        <th scope="row"><a href="#"><img src="<%= place.images[0] %>" alt=""></a></th>
                        <td><%= place.city %></td>
                        <td><%= place.area %></td>
                        <td class="fw-bold"><%= place.capacity %></td>
                        <td class="fw-bold"><%= place.budget %></td>
                      </tr>
  
  
                      
                      <% }); %>
                      
                      
                      
                    </tbody>
                  </table>
  
                </div>
  
              </div>
                  </div><!-- End Top Selling -->
                <%}%> 
            
            <% if (owner.isAdmin) {%>
              <!-- Top Selling -->
              <div class="col-12">
                <div class="card top-selling overflow-auto">
                  <div class="card-body pb-0">
                    <h5 class="card-title">Partner</h5>
                    <div class="filter">
                      <a class="icon" href="/admin/auth/partners">See All</a>
                  </div>
  
                <table class="table text-center">
                  <thead>
  
                    <tr>
                      <th scope="col">Picture</th>
                      <th scope="col">Name</th>
                      <th scope="col">Company</th>
                      <th scope="col">Type</th>
                      <th scope="col">Email</th>
                    </tr>
                  </thead>
                  <tbody class="text-center">
                    <% owners.forEach(function(owner){ %>
                    <tr>
                      <th scope="row"><a href="#"><img src="<%= owner.image %>" alt=""></a></th>
                    
                      <td><%= owner.ownername %></td>
                      <td><%= owner.companyname %></td>
                      <td><%= owner.type %></td>
                      <!-- <td class="fw-bold">10</td> -->
                      <td class="fw-bold"><%= owner.email %></td>
                    </tr>
                    <% }); %>
                  </tbody>
                </table>
  
              </div>
              
            </div>
              </div><!-- End Top Selling -->
            <%}%> 
  
          
            <!-- Sales Card -->
            <div class="col-xxl-6 col-md-6 my-4 text-center">
              <div class="card info-card sales-card">
  
                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>
  
                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>
  
                <div class="card-body my-4 pb-1 text-center">
                  <h5 class="card-title">Currently Requests <span>| Today</span></h5>
  
                  <div class="d-flex justify-content-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <i class="bi bi-ticket-perforated"></i>
                    </div>
                    <div class="ps-3">
                      <h6>145</h6>
                      <span class="text-success small pt-1 fw-bold">12%</span> <span class="text-muted small pt-2 ps-1">increase</span>
  
                    </div>
                  </div>
                </div>
  
              </div>
            </div><!-- End Sales Card -->
  
            <!-- Sales Card -->
            <div class="col-xxl-6 col-md-6 my-4 text-center">
              <div class="card info-card sales-card">
  
                <div class="filter">
                  <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                  <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                    <li class="dropdown-header text-start">
                      <h6>Filter</h6>
                    </li>
  
                    <li><a class="dropdown-item" href="#">Today</a></li>
                    <li><a class="dropdown-item" href="#">This Month</a></li>
                    <li><a class="dropdown-item" href="#">This Year</a></li>
                  </ul>
                </div>
  
                <div class="card-body my-4 pb-1 text-center">
                  <h5 class="card-title">Done Requests <span>| Today</span></h5>
  
                  <div class="d-flex justify-content-center">
                    <div class="card-icon rounded-circle d-flex align-items-center justify-content-center">
                      <i class="bi bi-check-circle"></i>
                    </div>
                    <div class="ps-3">
                      <h6>145</h6>
                      <span class="text-success small pt-1 fw-bold">12%</span> <span class="text-muted small pt-2 ps-1">increase</span>
  
                    </div>
                  </div>
                </div>
  
              </div>
            </div><!-- End Sales Card -->
  
          </div>
        </div><!-- End Left side columns -->
  
        <!-- Right side columns -->
        <div class="col-lg-4">
  
  
  <!-- if his login is owner -->
      
        <% if (!owner.isAdmin) {%>
            <% bookings.forEach(function(booking){ %>
              <div class="card h-auto">
  
                <div class="card-body pb-0">
                <h5 class="card-title">Request Booking</h5>
  
                <div class="news">
                  <div class="post-item clearfix">
                    
                    <div>
                      <img src="<%= booking.user.image %>" alt="">
                    </div>
                    <h4>Request from <%= booking.user.name %></h4>
                    <p><i class="bi bi-geo-alt pe-1"></i>Giza, Zamalek</p>
                    <p><i class="bi bi-calendar-event pe-1"></i>12/5/2023</p>
                    
                    <% if (booking.status === 'pending') {%> 
                      <span class="badge bg-info m-3"><%= booking.status %></span>
                    <%} else if(booking.status === 'approved') { %>                                                                                
                      <span class="badge bg-success m-3"><%= booking.status %></span>
                    <%} else if(booking.status === 'declined') { %>                                                                                
                      <span class="badge bg-warning m-3"><%= booking.status %></span>
                    <%} else { %>                                                                  
                    <span class="badge bg-danger m-3"><%= booking.status %></span>
                    <%}%>                   
                    <!-- <p><a href="dashboardRequestDetails.html">See request Information <i class="bi bi-caret-right-fill"></i></a></p> -->
                    <div class="row">
                                                                                      
                      <form class="col-md-6" method="POST" action="/bookings/update-status/<%= booking.id %>">
                        <input type="hidden" name="status" value="approved">
                        <button type="submit" title="APPROVE" class="btn p-2 btn-primary me-auto ms-3 ">APPROVE</button>
                      </form>
                      <form class="col-md-6" method="POST" action="/bookings/update-status/<%= booking.id %>">
                        <input type="hidden" name="status" value="declined">
                        <button type="submit" title="DECLINE" class="button2 btn p-2 btn-primary main-btn ms-2">DECLINE</button>
                      </form>
                    </div>
  
                </div>
                  </div>
                  
                </div><!-- End sidebar recent posts-->
              </div>
            <% }); %>
        <%}%> 
  
            
  
                <!-- if his login is admin -->
                
            <% if (owner.isAdmin) {%>
              <% leatesPlaces.forEach(function(place){ %>   
                <div class="card h-auto">
                  <div class="filter">
                    <a class="icon" href="#" data-bs-toggle="dropdown"><i class="bi bi-three-dots"></i></a>
                    <ul class="dropdown-menu dropdown-menu-end dropdown-menu-arrow">
                      <li class="dropdown-header text-start">
                        <h6>Filter</h6>
                      </li>
                      <li><a class="dropdown-item active" href="/admin/auth/branchesbooking">All</a></li>
                      
                      <li><a class="dropdown-item active" href="/admin/auth/branchesbooking">Waiting</a></li>
                     
                      <li><a class="dropdown-item active" href="/admin/auth/branchesbooking">Requests</a></li>
                    </ul>
                  </div>
      
                  <div class="card-body pb-0">
                  <h5 class="card-title">Request Booking</h5>
      
                  <div class="news">
                    <div class="post-item clearfix">
                      
                      <div>
                      <img src="<%= place.images[0] %>" alt=""> 
                      </div>
                     <h4>Request from <%= place.name %></h4>
                      <p><i class="bi bi-bookmark pe-1"></i><%= place.type %></p>
                      <p><i class="bi bi-geo-alt pe-1"></i><%= place.city %> , <%= place.area %></p>
                      <p><a href="/admin/auth/branchdetials/<%= place.id %>">See request Information <i class="bi bi-caret-right-fill"></i></a></p>
                      <p><i class="bi bi-calendar-event pe-1"></i><%= place.createdAt?.toDateString() %></p>
                      
                      <% if (place.status === 'pending') {%> 
                        <span class="badge bg-info m-3"><%= place.status %></span>
                      <%} else if(place.status === 'approved') { %>                                                                                
                        <span class="badge bg-success m-3"><%= place.status %></span>
                      <%} else if(place.status === 'declined') { %>                                                                                
                        <span class="badge bg-warning m-3"><%= place.status %></span>
                      <%} else { %>                                                                  
                      <span class="badge bg-danger m-3"><%= place.status %></span>
                      <%}%>                   
                      <!-- <p><a href="dashboardRequestDetails.html">See request Information <i class="bi bi-caret-right-fill"></i></a></p> -->
                      <div class="row">
                                                                                        
                        <form class="col-md-6" method="POST" action="/admin/places/update-status/<%= place.id %>">
                          <input type="hidden" name="status" value="approved">
                          <button type="submit" title="APPROVE" class="btn p-2 btn-primary me-auto ms-3 ">APPROVE</button>
                        </form>
                        <form class="col-md-6" method="POST" action="/admin/places/update-status/<%= place.id %>">
                          <input type="hidden" name="status" value="declined">
                          <button type="submit" title="DECLINE" class="button2 btn p-2 btn-primary main-btn ms-2">DECLINE</button>
                        </form>
                      </div>
      
                  </div>
                    </div>
                    
                  </div>
                </div>
                <% }); %>
             
              <%}%> 
      
  
          </div><!-- End News & Updates -->
        </div><!-- End Right side columns -->
  
      </div>
    </section>
  
  </main>